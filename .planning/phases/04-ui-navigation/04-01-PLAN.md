---
phase: 04-ui-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/state/ui.ts
  - src/components/HelpScreen.tsx
autonomous: true

must_haves:
  truths:
    - "Help screen modal can be toggled with ? key"
    - "Help screen displays all keyboard shortcuts"
    - "Help screen closes with ? or Esc"
  artifacts:
    - path: "src/state/ui.ts"
      provides: "UI state atoms for modal visibility"
      exports: ["showHelpAtom"]
    - path: "src/components/HelpScreen.tsx"
      provides: "Keyboard shortcuts modal overlay"
      exports: ["HelpScreen"]
  key_links:
    - from: "src/components/HelpScreen.tsx"
      to: "src/state/ui.ts"
      via: "useAtom(showHelpAtom)"
      pattern: "useAtom.*showHelpAtom"
---

<objective>
Create UI state management and the help screen modal component.

Purpose: Establish the state foundation for UI mode control (help visibility) and implement the keyboard shortcuts help screen (UI-03 requirement).

Output: UI state atoms in src/state/ui.ts and HelpScreen component in src/components/HelpScreen.tsx.
</objective>

<execution_context>
@/Users/nazim.saouli/.claude/get-shit-done/workflows/execute-plan.md
@/Users/nazim.saouli/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-ui-navigation/04-RESEARCH.md

# Existing patterns to follow
@src/state/settings.ts
@src/state/workspace.ts
@src/components/Settings.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create UI state atoms</name>
  <files>src/state/ui.ts</files>
  <action>
Create a new state file for UI-related atoms following existing patterns from settings.ts and workspace.ts:

1. Create `showHelpAtom` - primitive atom for help modal visibility (boolean, default false)
2. Export the atom for use in HelpScreen and ThreePaneLayout

Keep it simple - just the help modal state for now. No persistence needed (help visibility resets on app restart is fine).

Pattern to follow:
```typescript
import { atom } from 'jotai';

export const showHelpAtom = atom(false);
```
  </action>
  <verify>
File exists at src/state/ui.ts and exports showHelpAtom:
```bash
grep -l "showHelpAtom" src/state/ui.ts
```
  </verify>
  <done>src/state/ui.ts exists with showHelpAtom exported</done>
</task>

<task type="auto">
  <name>Task 2: Create HelpScreen component</name>
  <files>src/components/HelpScreen.tsx</files>
  <action>
Create the keyboard shortcuts help screen modal component following patterns from 04-RESEARCH.md:

1. Component accepts `onClose: () => void` prop
2. Uses `useInput` to handle ? and Escape keys for closing
3. Renders as modal overlay with:
   - Box with borderStyle="double", borderColor="yellow"
   - Organized sections: Navigation, Agent Control, Global
   - All current keyboard shortcuts documented
4. Uses position="absolute" or centered layout

Keyboard shortcuts to document:
- Navigation: Tab (next pane), Shift+Tab (prev pane)
- Agent Control: s (start), x (stop), r (restart), Enter (attach)
- Global: ? (help), q (quit), Esc (back/close)
- tmux: Ctrl+B D (detach from agent)

Follow the HelpScreen pattern from 04-RESEARCH.md code examples.

IMPORTANT: Do NOT handle ? key for opening - that's handled by the parent component.
The HelpScreen only handles closing itself.
  </action>
  <verify>
1. File exists at src/components/HelpScreen.tsx
2. Component compiles without errors:
```bash
npx tsc --noEmit src/components/HelpScreen.tsx 2>&1 | head -20
```
  </verify>
  <done>HelpScreen component renders keyboard shortcuts modal with ? and Esc to close</done>
</task>

</tasks>

<verification>
1. Both files exist and export correctly:
```bash
ls -la src/state/ui.ts src/components/HelpScreen.tsx
```

2. TypeScript compiles without errors:
```bash
npm run build
```

3. Exports are correct:
```bash
grep "export" src/state/ui.ts src/components/HelpScreen.tsx
```
</verification>

<success_criteria>
- src/state/ui.ts exists with showHelpAtom
- src/components/HelpScreen.tsx renders help modal
- Both files compile without TypeScript errors
- HelpScreen handles ? and Esc keys to close
</success_criteria>

<output>
After completion, create `.planning/phases/04-ui-navigation/04-01-SUMMARY.md`
</output>
