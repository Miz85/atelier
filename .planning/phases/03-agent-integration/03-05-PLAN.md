---
phase: 03-agent-integration
plan: 05
type: execute
wave: 4
depends_on: ["03-04"]
files_modified:
  - src/app.tsx
  - src/components/AgentView.tsx
autonomous: false

must_haves:
  truths:
    - "User can spawn Claude Code in a workspace"
    - "User can view agent output streaming in real-time"
    - "User can send input to agent"
    - "User can stop and restart agent"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete agent integration works end-to-end with a real Claude Code or OpenCode installation.

Purpose: Confirm all Phase 3 requirements are met with actual agent execution.
Output: Verified working agent integration
</objective>

<execution_context>
@/Users/nazim.saouli/.claude/get-shit-done/workflows/execute-plan.md
@/Users/nazim.saouli/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md

# All Phase 3 components
@src/agents/spawn.ts
@src/agents/types.ts
@src/state/agents.ts
@src/components/AgentOutput.tsx
@src/components/AgentControls.tsx
@src/components/AgentView.tsx
@src/app.tsx
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete agent integration with spawn, output display, input handling, and stop/restart controls</what-built>
  <how-to-verify>
1. Build and start the app:
   ```bash
   cd /Users/nazim.saouli/Projects/equipe
   npm run build && npm start
   ```

2. Create a workspace:
   - Press 'n' to create new workspace
   - Enter a test repository path (any git repo you have)
   - Enter a branch name
   - Select agent type (claude or opencode)
   - Workspace should be created

3. Open agent view:
   - Press 'w' to see workspace list
   - Select the new workspace
   - Press 'a' to open agent view

4. Verify agent output (AGENT-02):
   - Agent should start automatically or press 's' to start
   - Output should stream in real-time in the output box
   - Should see agent initialization messages

5. Test input (AGENT-03):
   - Press 'i' to enter input mode
   - Type a message (e.g., "hello")
   - Press Enter to send
   - Verify agent responds

6. Test stop (AGENT-04):
   - Press 'x' to stop the agent
   - Status should change to "stopped"
   - Output should stop streaming

7. Test restart (AGENT-05):
   - Press 'r' to restart
   - Agent should spawn again
   - Output should resume streaming

8. Test agent override (AGENT-07):
   - Go back and create another workspace
   - This time, select a different agent type than default
   - Verify the workspace uses the overridden agent type

Expected outcomes:
- All keyboard shortcuts respond correctly
- Output displays in real-time without flicker
- Stop/restart work reliably
- Agent type override is respected
  </how-to-verify>
  <resume-signal>Type "approved" if all requirements verified, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
All Phase 3 requirements verified:
- AGENT-01: Spawn Claude Code or OpenCode in workspace
- AGENT-02: View agent output in real-time
- AGENT-03: Send input to agent
- AGENT-04: Stop running agent
- AGENT-05: Restart stopped agent
- AGENT-06: Configure default agent (already done in Phase 1 Settings)
- AGENT-07: Override default agent when creating workspace
</verification>

<success_criteria>
All 7 AGENT requirements pass manual verification:
1. Agent spawns in workspace directory
2. Output streams in real-time
3. Input can be sent to agent
4. Agent can be stopped
5. Agent can be restarted
6. Default agent can be configured (Settings)
7. Agent type can be overridden per workspace
</success_criteria>

<output>
After completion, create `.planning/phases/03-agent-integration/03-05-SUMMARY.md`
</output>
